// Generated by CoffeeScript 1.6.3
var client;

client = new Dropbox.Client({
  key: '1n83me2ms50l6az'
});

client.authenticate(function(error, client) {
  if (error) {
    return console.log(error);
  }
});

window.Bridge = {
  saveTasks: function(tasks) {
    return client.writeFile('tasks.json', JSON.stringify(tasks));
  },
  getTasks: function(callback) {
    var tasks;
    tasks = [];
    return client.readFile('tasks.json', function(error, data) {
      if (error && error.status === Dropbox.ApiError.NOT_FOUND) {
        client.writeFile('tasks.json', JSON.stringify(tasks));
      } else {
        tasks = JSON.parse(data);
      }
      return callback(tasks);
    });
  },
  addTask: function(id, value) {
    return this.getTasks(function(tasks) {
      tasks.push({
        id: id,
        value: value
      });
      return Bridge.saveTasks(tasks);
    });
  },
  editTask: function(id, value) {},
  deleteTask: function(id) {
    return this.getTasks(function(tasks) {
      var i, task, _i, _len;
      for (i = _i = 0, _len = tasks.length; _i < _len; i = ++_i) {
        task = tasks[i];
        if (task.id === id) {
          tasks.splice(i, 1);
        }
      }
      return Bridge.saveTasks(tasks);
    });
  }
};

Bridge.deleteTask('NC94');
